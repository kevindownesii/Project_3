-- View: public.vw_geo_crime_census

-- DROP VIEW public.vw_geo_crime_census;

CREATE OR REPLACE VIEW public.vw_geo_crime_census
 AS
 SELECT a.county_id,
    a.murder_2018,
    a.rape_2018,
    a.robbery_2018,
    a.assualt_2018,
    a.burglary_2018,
    a.larceny_2018,
    a.auto_theft_2018,
    a.murder_2018 + a.rape_2018 + a.robbery_2018 + a.assualt_2018 + a.burglary_2018 + a.larceny_2018 + a.auto_theft_2018 AS total_2018,
    a.murder_2019,
    a.rape_2019,
    a.robbery_2019,
    a.assualt_2019,
    a.burglary_2019,
    a.larceny_2019,
    a.auto_theft_2019,
    a.murder_2019 + a.rape_2019 + a.robbery_2019 + a.assualt_2019 + a.burglary_2019 + a.larceny_2019 + a.auto_theft_2019 AS total_2019,
    a.murder_2020,
    a.rape_2020,
    a.robbery_2020,
    a.assualt_2020,
    a.burglary_2020,
    a.larceny_2020,
    a.auto_theft_2020,
    a.murder_2020 + a.rape_2020 + a.robbery_2020 + a.assualt_2020 + a.burglary_2020 + a.larceny_2020 + a.auto_theft_2020 AS total_2020,
    b."COUNTY_NAME",
    b."POPULATION_25_PLUS",
    b."MEDIAN_HOUSEHOLD_INCOME",
    b."HIGH_SCHOOL",
    b."BACHELOR",
    b."MASTERS",
    b."DOCTORATE",
    b."PROFESSIONAL",
    b."HIGH_SCHOOL_PERCENTAGE",
    b."BACHELOR_PERCENTAGE",
    b."MASTERS_PERCENTAGE",
    b."DOCTORATE_PERCENTAGE",
    b."PROFESSIONAL_PERCENTAGE",
    b."TOTAL_BACHELOR_PLUS_PERCENTAGE",
    c."OBJECTID",
    c."COUNTY",
    c."COUNTY_ID",
    c."COUNTY_LABEL",
    c."CO",
    c."GNIS_NAME",
    c."GNIS",
    c."FIPSSTCO",
    c."FIPSCO",
    c."ACRES",
    c."SQ_MILES",
    c."POP2020",
    c."POP2010",
    c."POP2000",
    c."POP1990",
    c."POP1980",
    c."POPDEN2020",
    c."POPDEN2010",
    c."POPDEN2000",
    c."POPDEN1990",
    c."POPDEN1980",
    c."REGION",
    c."Shape_Length",
    c."Shape_Area"
   FROM vw_crime_summary a,
    cleaned_census_data b,
    county_boundaries_of_nj c
  WHERE a.county_id = b."COUNTY_ID" AND b."COUNTY_ID" = c."COUNTY_ID";

ALTER TABLE public.vw_geo_crime_census
    OWNER TO postgres;

